import { Component, EventEmitter, Input, Output, } from '@angular/core';
import { BehaviorSubject } from 'rxjs';
import { v4 } from 'uuid';
import { YouTubeIFrameApiService, YouTubePlayerManagerService } from "../../interfaces/src/services";
import * as i0 from "@angular/core";
import * as i1 from "../../interfaces/src/services";
const booleanToNumericBoolean = (inputBoolean) => {
    if (inputBoolean === undefined)
        return undefined;
    return inputBoolean ? 1 : 0;
};
export class YouTubePlayerComponent {
    constructor(playerManager, iFrameApi) {
        this.playerManager = playerManager;
        this.iFrameApi = iFrameApi;
        this.htmlIdPrefix = 'ytPlayer-';
        this.privateHost = 'https://www.youtube-nocookie.com';
        this.nonPrivateHost = 'https://www.youtube.com';
        this.subscriptions = [];
        // IFrame API
        this.ready = new EventEmitter();
        this.stateChange = new EventEmitter();
        this.playbackQualityChange = new EventEmitter();
        this.errorOccurrence = new EventEmitter();
        this.playbackRateChange = new EventEmitter();
        this.apiChange = new EventEmitter();
        // Library
        this.playerChange = new EventEmitter();
        this._id = new BehaviorSubject(v4());
        this._width = 640;
        this._height = 390;
        this._player = new BehaviorSubject(undefined);
        this._autoplay = false;
        this._ccLangPref = undefined;
        this._ccLoadPolicy = false;
        this._color = 'red';
        this._controls = true;
        this._disablekb = false;
        this._enablejsapi = false;
        this._fs = true;
        this._hl = undefined;
        this._ivLoadPolicy = 1;
        this._list = undefined;
        this._listType = undefined;
        this._loop = false;
        this._modestbranding = false;
        this._origin = undefined;
        this._playlist = undefined;
        this._playsinline = undefined;
        this._rel = false;
        this._start = 0;
        this._widgetReferrer = undefined;
        this.htmlElementId = this.htmlIdPrefix + this.id;
        this._private = true;
        this.subscriptions.push(this.iFrameApi.apiChange.subscribe({
            error: (err) => {
                throw err;
            },
        }));
    }
    get autoplay() {
        return this._autoplay;
    }
    set autoplay(newAutoPlay) {
        this._autoplay = newAutoPlay;
        this.setupPlayerWithCurrentSetting();
    }
    get ccLangPref() {
        return this._ccLangPref;
    }
    set ccLangPref(newCcLangPref) {
        this._ccLangPref = newCcLangPref;
        this.setupPlayerWithCurrentSetting();
    }
    get ccLoadPolicy() {
        return this._ccLoadPolicy;
    }
    set ccLoadPolicy(newCcLoadPolicy) {
        this._ccLoadPolicy = newCcLoadPolicy;
        this.setupPlayerWithCurrentSetting();
    }
    get color() {
        return this._color;
    }
    set color(newColor) {
        this._color = newColor;
        this.setupPlayerWithCurrentSetting();
    }
    get controls() {
        return this._controls;
    }
    set controls(newControls) {
        this._controls = newControls;
        this.setupPlayerWithCurrentSetting();
    }
    get disablekb() {
        return this._disablekb;
    }
    set disablekb(newDisablekb) {
        this._disablekb = newDisablekb;
        this.setupPlayerWithCurrentSetting();
    }
    get enablejsapi() {
        return this._enablejsapi;
    }
    set enablejsapi(newEnablejsapi) {
        this._enablejsapi = newEnablejsapi;
        this.setupPlayerWithCurrentSetting();
    }
    get end() {
        return this._start;
    }
    set end(newEnd) {
        this._start = newEnd;
        this.setupPlayerWithCurrentSetting();
    }
    get fs() {
        return this._fs;
    }
    set fs(newFs) {
        this._fs = newFs;
        this.setupPlayerWithCurrentSetting();
    }
    get hl() {
        return this._hl;
    }
    set hl(newHl) {
        this._hl = newHl;
        this.setupPlayerWithCurrentSetting();
    }
    get ivLoadPolicy() {
        return this._ivLoadPolicy;
    }
    set ivLoadPolicy(newIvLoadPolicy) {
        this._ivLoadPolicy = newIvLoadPolicy;
        this.setupPlayerWithCurrentSetting();
    }
    get list() {
        return this._list;
    }
    set list(newList) {
        this._list = newList;
        if (newList && this.listType) {
            this.player?.loadPlaylist({
                list: newList,
                listType: this.listType,
            });
        }
    }
    get listType() {
        return this._listType;
    }
    set listType(newListType) {
        this._listType = newListType;
        if (newListType && this.list) {
            this.player?.loadPlaylist({
                list: this.list,
                listType: newListType,
            });
        }
    }
    get loop() {
        return this._loop;
    }
    set loop(newLoop) {
        this._loop = newLoop;
        this.player?.setLoop(newLoop);
    }
    get modestbranding() {
        return this._modestbranding;
    }
    set modestbranding(newModestbranding) {
        this._modestbranding = newModestbranding;
        this.setupPlayerWithCurrentSetting();
    }
    get origin() {
        return this._origin;
    }
    set origin(newOrigin) {
        this._origin = newOrigin;
        this.setupPlayerWithCurrentSetting();
    }
    get playlist() {
        return this._playlist;
    }
    set playlist(newPlaylist) {
        this._playlist = newPlaylist;
        this.setupPlayerWithCurrentSetting();
    }
    get playsinline() {
        return this._playsinline;
    }
    set playsinline(newPlaysinline) {
        this._playsinline = newPlaysinline;
        this.setupPlayerWithCurrentSetting();
    }
    get rel() {
        return this._rel;
    }
    set rel(newRel) {
        this._rel = newRel;
        this.setupPlayerWithCurrentSetting();
    }
    get start() {
        return this._start;
    }
    set start(newStart) {
        this._start = newStart;
        this.setupPlayerWithCurrentSetting();
    }
    get widgetReferrer() {
        return this._widgetReferrer;
    }
    set widgetReferrer(newWidgetReferrer) {
        this._widgetReferrer = newWidgetReferrer;
        this.setupPlayerWithCurrentSetting();
    }
    get private() {
        return this._private;
    }
    set private(newPrivate) {
        if (this._private !== newPrivate) {
            this._private = newPrivate;
            this.setupPlayerWithCurrentSetting();
        }
    }
    get id() {
        return this._id.value;
    }
    set id(newId) {
        const prevId = this._id.value;
        if (this.playerManager.has(prevId)) {
            this.playerManager.delete(prevId);
        }
        this._id.next(newId);
        if (this.player) {
            this.addToPlayerManager(this.player);
        }
        this.htmlElementId = this.htmlIdPrefix + newId;
    }
    get height() {
        return this._height;
    }
    set height(newHeight) {
        this._height = newHeight;
        this.player?.setSize(this.width, this.height);
    }
    get width() {
        return this._width;
    }
    set width(newWidth) {
        this._width = newWidth;
        this.player?.setSize(this.width, this.height);
    }
    get videoId() {
        return this._videoId;
    }
    set videoId(newVideoId) {
        this._videoId = newVideoId;
        this.player?.loadVideoById(this.videoId, this.start);
    }
    get api() {
        return this.iFrameApi.api;
    }
    get player() {
        return this._player.value;
    }
    set player(newPlayer) {
        this._player.next(newPlayer);
    }
    ngOnInit() {
        this.subscriptions.push(this._player.subscribe((newPlayer) => {
            this.playerChange.emit(newPlayer);
        }));
        this.setupPlayerWithCurrentSetting();
    }
    ngOnDestroy() {
        this.subscriptions.forEach((x) => x.unsubscribe());
        this.ready.complete();
        this.stateChange.complete();
        this.apiChange.complete();
        this.playbackRateChange.complete();
        this.playbackQualityChange.complete();
        this.playerChange.complete();
        this.ready.complete();
        this.stateChange.complete();
        this.apiChange.complete();
        this.playbackQualityChange.complete();
        this.playbackRateChange.complete();
        this.errorOccurrence.complete();
        this._player.complete();
    }
    setupPlayerWithCurrentSetting() {
        this.setupPlayerWith(this.htmlElementId, {
            height: this.height,
            width: this.width,
            videoId: this.videoId,
            host: this.private ? this.privateHost : this.nonPrivateHost,
            playerVars: {
                autoplay: booleanToNumericBoolean(this.autoplay),
                cc_lang_pref: this.ccLangPref,
                cc_load_policy: booleanToNumericBoolean(this.ccLoadPolicy),
                color: this.color,
                controls: booleanToNumericBoolean(this.controls),
                disablekb: booleanToNumericBoolean(this.disablekb),
                enablejsapi: booleanToNumericBoolean(this.enablejsapi),
                end: this.end,
                fs: booleanToNumericBoolean(this.fs),
                hl: this.hl,
                iv_load_policy: this.ivLoadPolicy,
                list: this.list,
                listType: this.listType,
                loop: booleanToNumericBoolean(this.loop),
                modestbranding: booleanToNumericBoolean(this.modestbranding),
                origin: this.origin,
                playlist: this.playlist,
                playsinline: booleanToNumericBoolean(this.playsinline),
                rel: booleanToNumericBoolean(this.rel),
                start: this.start,
                widget_referrer: this.widgetReferrer,
            },
        });
    }
    setupPlayerWith(elementId, config) {
        const subscription = this.iFrameApi.apiChange.subscribe((api) => {
            if (!api) {
                return;
            }
            const player = new api.Player(elementId, {
                ...config,
                events: {
                    onReady: () => {
                        this.player = player;
                        this.addToPlayerManager(player);
                        this.ready.emit();
                        subscription.unsubscribe();
                    },
                    onStateChange: (event) => {
                        this.stateChange.emit(event.data);
                    },
                    onApiChange: (event) => {
                        this.apiChange.emit(event);
                    },
                    onError: (event) => {
                        this.errorOccurrence.emit(event.data);
                    },
                    onPlaybackQualityChange: (event) => {
                        this.playbackQualityChange.emit(event.data);
                    },
                    onPlaybackRateChange: (event) => {
                        this.playbackRateChange.emit(event.data);
                    },
                },
            });
        });
    }
    addToPlayerManager(newPlayer) {
        this.playerManager.add(this.id, {
            player: newPlayer,
            ready: this.ready.asObservable(),
            stateChange: this.stateChange.asObservable(),
            apiChange: this.apiChange.asObservable(),
            playbackQualityChange: this.playbackQualityChange.asObservable(),
            playbackRateChange: this.playbackRateChange.asObservable(),
            errorOccurrence: this.errorOccurrence.asObservable(),
        });
    }
}
YouTubePlayerComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "13.2.1", ngImport: i0, type: YouTubePlayerComponent, deps: [{ token: i1.YouTubePlayerManagerService }, { token: i1.YouTubeIFrameApiService }], target: i0.ɵɵFactoryTarget.Component });
YouTubePlayerComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "12.0.0", version: "13.2.1", type: YouTubePlayerComponent, selector: "g-youtube-player", inputs: { autoplay: "autoplay", ccLangPref: "ccLangPref", ccLoadPolicy: "ccLoadPolicy", color: "color", controls: "controls", disablekb: "disablekb", enablejsapi: "enablejsapi", end: "end", fs: "fs", hl: "hl", ivLoadPolicy: "ivLoadPolicy", list: "list", listType: "listType", loop: "loop", modestbranding: "modestbranding", origin: "origin", playlist: "playlist", playsinline: "playsinline", rel: "rel", start: "start", widgetReferrer: "widgetReferrer", private: "private", id: "id", height: "height", width: "width", videoId: "videoId" }, outputs: { ready: "ready", stateChange: "stateChange", playbackQualityChange: "playbackQualityChange", errorOccurrence: "errorOccurrence", playbackRateChange: "playbackRateChange", apiChange: "apiChange", playerChange: "playerChange" }, ngImport: i0, template: "<div [id]=\"htmlElementId\"></div>\n", styles: [""] });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "13.2.1", ngImport: i0, type: YouTubePlayerComponent, decorators: [{
            type: Component,
            args: [{ selector: 'g-youtube-player', template: "<div [id]=\"htmlElementId\"></div>\n", styles: [""] }]
        }], ctorParameters: function () { return [{ type: i1.YouTubePlayerManagerService }, { type: i1.YouTubeIFrameApiService }]; }, propDecorators: { ready: [{
                type: Output
            }], stateChange: [{
                type: Output
            }], playbackQualityChange: [{
                type: Output
            }], errorOccurrence: [{
                type: Output
            }], playbackRateChange: [{
                type: Output
            }], apiChange: [{
                type: Output
            }], playerChange: [{
                type: Output
            }], autoplay: [{
                type: Input
            }], ccLangPref: [{
                type: Input
            }], ccLoadPolicy: [{
                type: Input
            }], color: [{
                type: Input
            }], controls: [{
                type: Input
            }], disablekb: [{
                type: Input
            }], enablejsapi: [{
                type: Input
            }], end: [{
                type: Input
            }], fs: [{
                type: Input
            }], hl: [{
                type: Input
            }], ivLoadPolicy: [{
                type: Input
            }], list: [{
                type: Input
            }], listType: [{
                type: Input
            }], loop: [{
                type: Input
            }], modestbranding: [{
                type: Input
            }], origin: [{
                type: Input
            }], playlist: [{
                type: Input
            }], playsinline: [{
                type: Input
            }], rel: [{
                type: Input
            }], start: [{
                type: Input
            }], widgetReferrer: [{
                type: Input
            }], private: [{
                type: Input
            }], id: [{
                type: Input
            }], height: [{
                type: Input
            }], width: [{
                type: Input
            }], videoId: [{
                type: Input
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoieW91dHViZS1wbGF5ZXIuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vbGlicy95b3V0dWJlLXBsYXllci9zcmMveW91dHViZS1wbGF5ZXIvc3JjL3lvdXR1YmUtcGxheWVyLmNvbXBvbmVudC50cyIsIi4uLy4uLy4uLy4uLy4uLy4uL2xpYnMveW91dHViZS1wbGF5ZXIvc3JjL3lvdXR1YmUtcGxheWVyL3NyYy95b3V0dWJlLXBsYXllci5jb21wb25lbnQuaHRtbCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQ0wsU0FBUyxFQUNULFlBQVksRUFDWixLQUFLLEVBR0wsTUFBTSxHQUNQLE1BQU0sZUFBZSxDQUFDO0FBQ3ZCLE9BQU8sRUFBRSxlQUFlLEVBQWdCLE1BQU0sTUFBTSxDQUFDO0FBQ3JELE9BQU8sRUFBRSxFQUFFLEVBQUUsTUFBTSxNQUFNLENBQUM7QUFRMUIsT0FBTyxFQUFDLHVCQUF1QixFQUFFLDJCQUEyQixFQUFDLE1BQU0sK0JBQStCLENBQUM7OztBQUVuRyxNQUFNLHVCQUF1QixHQUFHLENBQzlCLFlBQWlDLEVBQ0wsRUFBRTtJQUM5QixJQUFJLFlBQVksS0FBSyxTQUFTO1FBQUUsT0FBTyxTQUFTLENBQUM7SUFFakQsT0FBTyxZQUFZLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQzlCLENBQUMsQ0FBQztBQU9GLE1BQU0sT0FBTyxzQkFBc0I7SUF3VmpDLFlBQ1UsYUFBMEMsRUFDMUMsU0FBa0M7UUFEbEMsa0JBQWEsR0FBYixhQUFhLENBQTZCO1FBQzFDLGNBQVMsR0FBVCxTQUFTLENBQXlCO1FBelZsQyxpQkFBWSxHQUFHLFdBQVcsQ0FBQztRQUMzQixnQkFBVyxHQUFHLGtDQUFrQyxDQUFDO1FBQ2pELG1CQUFjLEdBQUcseUJBQXlCLENBQUM7UUFFM0Msa0JBQWEsR0FBbUIsRUFBRSxDQUFDO1FBRTdDLGFBQWE7UUFD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O3NCQUFkLE1BQU07Z0JBQ0csV0FBVztzQkFBcEIsTUFBTTtnQkFDRyxxQkFBcUI7c0JBQTlCLE1BQU07Z0JBRUcsZUFBZTtzQkFBeEIsTUFBTTtnQkFDRyxrQkFBa0I7c0JBQTNCLE1BQU07Z0JBQ0csU0FBUztzQkFBbEIsTUFBTTtnQkFHRyxZQUFZO3NCQUFyQixNQUFNO2dCQStCSCxRQUFRO3NCQURYLEtBQUs7Z0JBV0YsVUFBVTtzQkFEYixLQUFLO2dCQVdGLFlBQVk7c0JBRGYsS0FBSztnQkFXRixLQUFLO3NCQURSLEtBQUs7Z0JBV0YsUUFBUTtzQkFEWCxLQUFLO2dCQVdGLFNBQVM7c0JBRFosS0FBSztnQkFXRixXQUFXO3NCQURkLEtBQUs7Z0JBV0YsR0FBRztzQkFETixLQUFLO2dCQVdGLEVBQUU7c0JBREwsS0FBSztnQkFXRixFQUFFO3NCQURMLEtBQUs7Z0JBV0YsWUFBWTtzQkFEZixLQUFLO2dCQVdGLElBQUk7c0JBRFAsS0FBSztnQkFnQkYsUUFBUTtzQkFEWCxLQUFLO2dCQWdCRixJQUFJO3NCQURQLEtBQUs7Z0JBV0YsY0FBYztzQkFEakIsS0FBSztnQkFXRixNQUFNO3NCQURULEtBQUs7Z0JBV0YsUUFBUTtzQkFEWCxLQUFLO2dCQVdGLFdBQVc7c0JBRGQsS0FBSztnQkFXRixHQUFHO3NCQUROLEtBQUs7Z0JBV0YsS0FBSztzQkFEUixLQUFLO2dCQVdGLGNBQWM7c0JBRGpCLEtBQUs7Z0JBY0YsT0FBTztzQkFEVixLQUFLO2dCQWFGLEVBQUU7c0JBREwsS0FBSztnQkFxQkYsTUFBTTtzQkFEVCxLQUFLO2dCQVdGLEtBQUs7c0JBRFIsS0FBSztnQkFXRixPQUFPO3NCQURWLEtBQUsiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBDb21wb25lbnQsXG4gIEV2ZW50RW1pdHRlcixcbiAgSW5wdXQsXG4gIE9uRGVzdHJveSxcbiAgT25Jbml0LFxuICBPdXRwdXQsXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgQmVoYXZpb3JTdWJqZWN0LCBTdWJzY3JpcHRpb24gfSBmcm9tICdyeGpzJztcbmltcG9ydCB7IHY0IH0gZnJvbSAndXVpZCc7XG5pbXBvcnQge1xuICBJU082MzkxVHdvTGV0dGVyTGFuZ3VhZ2VDb2RlLFxuICBOdW1lcmljQm9vbGVhbiwgWW91VHViZUNvbmZpZywgWW91VHViZUlGcmFtZUFwaSxcbiAgWW91VHViZU51bWVyaWNQbGF5ZXJFcnJvcixcbiAgWW91VHViZU51bWVyaWNQbGF5ZXJTdGF0ZSwgWW91VHViZVBsYXllciwgWW91VHViZVBsYXllckNvbG9yLCBZb3VUdWJlUGxheWVySVZMb2FkUG9saWN5LCBZb3VUdWJlUGxheWVyTGlzdFR5cGUsXG4gIFlvdVR1YmVQbGF5ZXJRdWFsaXR5U2V0dGluZ1xufSBmcm9tICcuLi8uLi9pbnRlcmZhY2VzL3NyYy95b3V0dWJlLWFwaSc7XG5pbXBvcnQge1lvdVR1YmVJRnJhbWVBcGlTZXJ2aWNlLCBZb3VUdWJlUGxheWVyTWFuYWdlclNlcnZpY2V9IGZyb20gXCIuLi8uLi9pbnRlcmZhY2VzL3NyYy9zZXJ2aWNlc1wiO1xuXG5jb25zdCBib29sZWFuVG9OdW1lcmljQm9vbGVhbiA9IChcbiAgaW5wdXRCb29sZWFuOiBib29sZWFuIHwgdW5kZWZpbmVkXG4pOiBOdW1lcmljQm9vbGVhbiB8IHVuZGVmaW5lZCA9PiB7XG4gIGlmIChpbnB1dEJvb2xlYW4gPT09IHVuZGVmaW5lZCkgcmV0dXJuIHVuZGVmaW5lZDtcblxuICByZXR1cm4gaW5wdXRCb29sZWFuID8gMSA6IDA7XG59O1xuXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICdnLXlvdXR1YmUtcGxheWVyJyxcbiAgdGVtcGxhdGVVcmw6ICcuL3lvdXR1YmUtcGxheWVyLmNvbXBvbmVudC5odG1sJyxcbiAgc3R5bGVVcmxzOiBbJy4veW91dHViZS1wbGF5ZXIuY29tcG9uZW50LnNjc3MnXSxcbn0pXG5leHBvcnQgY2xhc3MgWW91VHViZVBsYXllckNvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCwgT25EZXN0cm95IHtcbiAgcHJvdGVjdGVkIGh0bWxJZFByZWZpeCA9ICd5dFBsYXllci0nO1xuICBwcm90ZWN0ZWQgcHJpdmF0ZUhvc3QgPSAnaHR0cHM6Ly93d3cueW91dHViZS1ub2Nvb2tpZS5jb20nO1xuICBwcm90ZWN0ZWQgbm9uUHJpdmF0ZUhvc3QgPSAnaHR0cHM6Ly93d3cueW91dHViZS5jb20nO1xuXG4gIHByb3RlY3RlZCBzdWJzY3JpcHRpb25zOiBTdWJzY3JpcHRpb25bXSA9IFtdO1xuXG4gIC8vIElGcmFtZSBBUElcbiAgQE91dHB1dCgpIHJlYWR5ID0gbmV3IEV2ZW50RW1pdHRlcjx2b2lkPigpO1xuICBAT3V0cHV0KCkgc3RhdGVDaGFuZ2UgPSBuZXcgRXZlbnRFbWl0dGVyPFlvdVR1YmVOdW1lcmljUGxheWVyU3RhdGU+KCk7XG4gIEBPdXRwdXQoKSBwbGF5YmFja1F1YWxpdHlDaGFuZ2UgPVxuICAgIG5ldyBFdmVudEVtaXR0ZXI8WW91VHViZVBsYXllclF1YWxpdHlTZXR0aW5nPigpO1xuICBAT3V0cHV0KCkgZXJyb3JPY2N1cnJlbmNlID0gbmV3IEV2ZW50RW1pdHRlcjxZb3VUdWJlTnVtZXJpY1BsYXllckVycm9yPigpO1xuICBAT3V0cHV0KCkgcGxheWJhY2tSYXRlQ2hhbmdlID0gbmV3IEV2ZW50RW1pdHRlcjxudW1iZXI+KCk7XG4gIEBPdXRwdXQoKSBhcGlDaGFuZ2UgPSBuZXcgRXZlbnRFbWl0dGVyPHVua25vd24+KCk7XG5cbiAgLy8gTGlicmFyeVxuICBAT3V0cHV0KCkgcGxheWVyQ2hhbmdlID0gbmV3IEV2ZW50RW1pdHRlcjxZb3VUdWJlUGxheWVyPigpO1xuXG4gIHByb3RlY3RlZCBfaWQgPSBuZXcgQmVoYXZpb3JTdWJqZWN0PHN0cmluZz4odjQoKSk7XG4gIHByb3RlY3RlZCBfd2lkdGggPSA2NDA7XG4gIHByb3RlY3RlZCBfaGVpZ2h0ID0gMzkwO1xuICBwcm90ZWN0ZWQgX3ZpZGVvSWQhOiBzdHJpbmc7XG4gIHByb3RlY3RlZCBfcGxheWVyID0gbmV3IEJlaGF2aW9yU3ViamVjdDx1bmRlZmluZWQgfCBZb3VUdWJlUGxheWVyPih1bmRlZmluZWQpO1xuXG4gIHByb3RlY3RlZCBfYXV0b3BsYXkgPSBmYWxzZTtcbiAgcHJvdGVjdGVkIF9jY0xhbmdQcmVmOiBJU082MzkxVHdvTGV0dGVyTGFuZ3VhZ2VDb2RlIHwgdW5kZWZpbmVkID0gdW5kZWZpbmVkO1xuICBwcm90ZWN0ZWQgX2NjTG9hZFBvbGljeSA9IGZhbHNlO1xuICBwcm90ZWN0ZWQgX2NvbG9yOiBZb3VUdWJlUGxheWVyQ29sb3IgPSAncmVkJztcbiAgcHJvdGVjdGVkIF9jb250cm9scyA9IHRydWU7XG4gIHByb3RlY3RlZCBfZGlzYWJsZWtiID0gZmFsc2U7XG4gIHByb3RlY3RlZCBfZW5hYmxlanNhcGkgPSBmYWxzZTtcbiAgcHJvdGVjdGVkIF9lbmQ6IG51bWJlciB8IHVuZGVmaW5lZDtcbiAgcHJvdGVjdGVkIF9mcyA9IHRydWU7XG4gIHByb3RlY3RlZCBfaGw6IElTTzYzOTFUd29MZXR0ZXJMYW5ndWFnZUNvZGUgfCB1bmRlZmluZWQgPSB1bmRlZmluZWQ7XG4gIHByb3RlY3RlZCBfaXZMb2FkUG9saWN5OiBZb3VUdWJlUGxheWVySVZMb2FkUG9saWN5ID0gMTtcbiAgcHJvdGVjdGVkIF9saXN0OiBzdHJpbmcgfCB1bmRlZmluZWQgPSB1bmRlZmluZWQ7XG4gIHByb3RlY3RlZCBfbGlzdFR5cGU6IFlvdVR1YmVQbGF5ZXJMaXN0VHlwZSB8IHVuZGVmaW5lZCA9IHVuZGVmaW5lZDtcbiAgcHJvdGVjdGVkIF9sb29wID0gZmFsc2U7XG4gIHByb3RlY3RlZCBfbW9kZXN0YnJhbmRpbmcgPSBmYWxzZTtcbiAgcHJvdGVjdGVkIF9vcmlnaW46IHN0cmluZyB8IHVuZGVmaW5lZCA9IHVuZGVmaW5lZDtcbiAgcHJvdGVjdGVkIF9wbGF5bGlzdDogc3RyaW5nIHwgdW5kZWZpbmVkID0gdW5kZWZpbmVkO1xuICBwcm90ZWN0ZWQgX3BsYXlzaW5saW5lOiBib29sZWFuIHwgdW5kZWZpbmVkID0gdW5kZWZpbmVkO1xuICBwcm90ZWN0ZWQgX3JlbCA9IGZhbHNlO1xuICBfc3RhcnQgPSAwO1xuICBwcm90ZWN0ZWQgX3dpZGdldFJlZmVycmVyOiBzdHJpbmcgfCB1bmRlZmluZWQgPSB1bmRlZmluZWQ7XG5cbiAgQElucHV0KClcbiAgZ2V0IGF1dG9wbGF5KCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLl9hdXRvcGxheTtcbiAgfVxuXG4gIHNldCBhdXRvcGxheShuZXdBdXRvUGxheSkge1xuICAgIHRoaXMuX2F1dG9wbGF5ID0gbmV3QXV0b1BsYXk7XG4gICAgdGhpcy5zZXR1cFBsYXllcldpdGhDdXJyZW50U2V0dGluZygpO1xuICB9XG5cbiAgQElucHV0KClcbiAgZ2V0IGNjTGFuZ1ByZWYoKTogSVNPNjM5MVR3b0xldHRlckxhbmd1YWdlQ29kZSB8IHVuZGVmaW5lZCB7XG4gICAgcmV0dXJuIHRoaXMuX2NjTGFuZ1ByZWY7XG4gIH1cblxuICBzZXQgY2NMYW5nUHJlZihuZXdDY0xhbmdQcmVmKSB7XG4gICAgdGhpcy5fY2NMYW5nUHJlZiA9IG5ld0NjTGFuZ1ByZWY7XG4gICAgdGhpcy5zZXR1cFBsYXllcldpdGhDdXJyZW50U2V0dGluZygpO1xuICB9XG5cbiAgQElucHV0KClcbiAgZ2V0IGNjTG9hZFBvbGljeSgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5fY2NMb2FkUG9saWN5O1xuICB9XG5cbiAgc2V0IGNjTG9hZFBvbGljeShuZXdDY0xvYWRQb2xpY3kpIHtcbiAgICB0aGlzLl9jY0xvYWRQb2xpY3kgPSBuZXdDY0xvYWRQb2xpY3k7XG4gICAgdGhpcy5zZXR1cFBsYXllcldpdGhDdXJyZW50U2V0dGluZygpO1xuICB9XG5cbiAgQElucHV0KClcbiAgZ2V0IGNvbG9yKCk6IFlvdVR1YmVQbGF5ZXJDb2xvciB7XG4gICAgcmV0dXJuIHRoaXMuX2NvbG9yO1xuICB9XG5cbiAgc2V0IGNvbG9yKG5ld0NvbG9yKSB7XG4gICAgdGhpcy5fY29sb3IgPSBuZXdDb2xvcjtcbiAgICB0aGlzLnNldHVwUGxheWVyV2l0aEN1cnJlbnRTZXR0aW5nKCk7XG4gIH1cblxuICBASW5wdXQoKVxuICBnZXQgY29udHJvbHMoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuX2NvbnRyb2xzO1xuICB9XG5cbiAgc2V0IGNvbnRyb2xzKG5ld0NvbnRyb2xzKSB7XG4gICAgdGhpcy5fY29udHJvbHMgPSBuZXdDb250cm9scztcbiAgICB0aGlzLnNldHVwUGxheWVyV2l0aEN1cnJlbnRTZXR0aW5nKCk7XG4gIH1cblxuICBASW5wdXQoKVxuICBnZXQgZGlzYWJsZWtiKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLl9kaXNhYmxla2I7XG4gIH1cblxuICBzZXQgZGlzYWJsZWtiKG5ld0Rpc2FibGVrYikge1xuICAgIHRoaXMuX2Rpc2FibGVrYiA9IG5ld0Rpc2FibGVrYjtcbiAgICB0aGlzLnNldHVwUGxheWVyV2l0aEN1cnJlbnRTZXR0aW5nKCk7XG4gIH1cblxuICBASW5wdXQoKVxuICBnZXQgZW5hYmxlanNhcGkoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuX2VuYWJsZWpzYXBpO1xuICB9XG5cbiAgc2V0IGVuYWJsZWpzYXBpKG5ld0VuYWJsZWpzYXBpKSB7XG4gICAgdGhpcy5fZW5hYmxlanNhcGkgPSBuZXdFbmFibGVqc2FwaTtcbiAgICB0aGlzLnNldHVwUGxheWVyV2l0aEN1cnJlbnRTZXR0aW5nKCk7XG4gIH1cblxuICBASW5wdXQoKVxuICBnZXQgZW5kKCk6IG51bWJlciB7XG4gICAgcmV0dXJuIHRoaXMuX3N0YXJ0O1xuICB9XG5cbiAgc2V0IGVuZChuZXdFbmQ6IG51bWJlcikge1xuICAgIHRoaXMuX3N0YXJ0ID0gbmV3RW5kO1xuICAgIHRoaXMuc2V0dXBQbGF5ZXJXaXRoQ3VycmVudFNldHRpbmcoKTtcbiAgfVxuXG4gIEBJbnB1dCgpXG4gIGdldCBmcygpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5fZnM7XG4gIH1cblxuICBzZXQgZnMobmV3RnMpIHtcbiAgICB0aGlzLl9mcyA9IG5ld0ZzO1xuICAgIHRoaXMuc2V0dXBQbGF5ZXJXaXRoQ3VycmVudFNldHRpbmcoKTtcbiAgfVxuXG4gIEBJbnB1dCgpXG4gIGdldCBobCgpOiBJU082MzkxVHdvTGV0dGVyTGFuZ3VhZ2VDb2RlIHwgdW5kZWZpbmVkIHtcbiAgICByZXR1cm4gdGhpcy5faGw7XG4gIH1cblxuICBzZXQgaGwobmV3SGwpIHtcbiAgICB0aGlzLl9obCA9IG5ld0hsO1xuICAgIHRoaXMuc2V0dXBQbGF5ZXJXaXRoQ3VycmVudFNldHRpbmcoKTtcbiAgfVxuXG4gIEBJbnB1dCgpXG4gIGdldCBpdkxvYWRQb2xpY3koKTogWW91VHViZVBsYXllcklWTG9hZFBvbGljeSB7XG4gICAgcmV0dXJuIHRoaXMuX2l2TG9hZFBvbGljeTtcbiAgfVxuXG4gIHNldCBpdkxvYWRQb2xpY3kobmV3SXZMb2FkUG9saWN5KSB7XG4gICAgdGhpcy5faXZMb2FkUG9saWN5ID0gbmV3SXZMb2FkUG9saWN5O1xuICAgIHRoaXMuc2V0dXBQbGF5ZXJXaXRoQ3VycmVudFNldHRpbmcoKTtcbiAgfVxuXG4gIEBJbnB1dCgpXG4gIGdldCBsaXN0KCk6IHN0cmluZyB8IHVuZGVmaW5lZCB7XG4gICAgcmV0dXJuIHRoaXMuX2xpc3Q7XG4gIH1cblxuICBzZXQgbGlzdChuZXdMaXN0KSB7XG4gICAgdGhpcy5fbGlzdCA9IG5ld0xpc3Q7XG4gICAgaWYgKG5ld0xpc3QgJiYgdGhpcy5saXN0VHlwZSkge1xuICAgICAgdGhpcy5wbGF5ZXI/LmxvYWRQbGF5bGlzdCh7XG4gICAgICAgIGxpc3Q6IG5ld0xpc3QsXG4gICAgICAgIGxpc3RUeXBlOiB0aGlzLmxpc3RUeXBlLFxuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgQElucHV0KClcbiAgZ2V0IGxpc3RUeXBlKCk6IFlvdVR1YmVQbGF5ZXJMaXN0VHlwZSB8IHVuZGVmaW5lZCB7XG4gICAgcmV0dXJuIHRoaXMuX2xpc3RUeXBlO1xuICB9XG5cbiAgc2V0IGxpc3RUeXBlKG5ld0xpc3RUeXBlKSB7XG4gICAgdGhpcy5fbGlzdFR5cGUgPSBuZXdMaXN0VHlwZTtcbiAgICBpZiAobmV3TGlzdFR5cGUgJiYgdGhpcy5saXN0KSB7XG4gICAgICB0aGlzLnBsYXllcj8ubG9hZFBsYXlsaXN0KHtcbiAgICAgICAgbGlzdDogdGhpcy5saXN0LFxuICAgICAgICBsaXN0VHlwZTogbmV3TGlzdFR5cGUsXG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICBASW5wdXQoKVxuICBnZXQgbG9vcCgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5fbG9vcDtcbiAgfVxuXG4gIHNldCBsb29wKG5ld0xvb3ApIHtcbiAgICB0aGlzLl9sb29wID0gbmV3TG9vcDtcbiAgICB0aGlzLnBsYXllcj8uc2V0TG9vcChuZXdMb29wKTtcbiAgfVxuXG4gIEBJbnB1dCgpXG4gIGdldCBtb2Rlc3RicmFuZGluZygpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5fbW9kZXN0YnJhbmRpbmc7XG4gIH1cblxuICBzZXQgbW9kZXN0YnJhbmRpbmcobmV3TW9kZXN0YnJhbmRpbmcpIHtcbiAgICB0aGlzLl9tb2Rlc3RicmFuZGluZyA9IG5ld01vZGVzdGJyYW5kaW5nO1xuICAgIHRoaXMuc2V0dXBQbGF5ZXJXaXRoQ3VycmVudFNldHRpbmcoKTtcbiAgfVxuXG4gIEBJbnB1dCgpXG4gIGdldCBvcmlnaW4oKTogc3RyaW5nIHwgdW5kZWZpbmVkIHtcbiAgICByZXR1cm4gdGhpcy5fb3JpZ2luO1xuICB9XG5cbiAgc2V0IG9yaWdpbihuZXdPcmlnaW4pIHtcbiAgICB0aGlzLl9vcmlnaW4gPSBuZXdPcmlnaW47XG4gICAgdGhpcy5zZXR1cFBsYXllcldpdGhDdXJyZW50U2V0dGluZygpO1xuICB9XG5cbiAgQElucHV0KClcbiAgZ2V0IHBsYXlsaXN0KCk6IHN0cmluZyB8IHVuZGVmaW5lZCB7XG4gICAgcmV0dXJuIHRoaXMuX3BsYXlsaXN0O1xuICB9XG5cbiAgc2V0IHBsYXlsaXN0KG5ld1BsYXlsaXN0KSB7XG4gICAgdGhpcy5fcGxheWxpc3QgPSBuZXdQbGF5bGlzdDtcbiAgICB0aGlzLnNldHVwUGxheWVyV2l0aEN1cnJlbnRTZXR0aW5nKCk7XG4gIH1cblxuICBASW5wdXQoKVxuICBnZXQgcGxheXNpbmxpbmUoKTogYm9vbGVhbiB8IHVuZGVmaW5lZCB7XG4gICAgcmV0dXJuIHRoaXMuX3BsYXlzaW5saW5lO1xuICB9XG5cbiAgc2V0IHBsYXlzaW5saW5lKG5ld1BsYXlzaW5saW5lKSB7XG4gICAgdGhpcy5fcGxheXNpbmxpbmUgPSBuZXdQbGF5c2lubGluZTtcbiAgICB0aGlzLnNldHVwUGxheWVyV2l0aEN1cnJlbnRTZXR0aW5nKCk7XG4gIH1cblxuICBASW5wdXQoKVxuICBnZXQgcmVsKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLl9yZWw7XG4gIH1cblxuICBzZXQgcmVsKG5ld1JlbCkge1xuICAgIHRoaXMuX3JlbCA9IG5ld1JlbDtcbiAgICB0aGlzLnNldHVwUGxheWVyV2l0aEN1cnJlbnRTZXR0aW5nKCk7XG4gIH1cblxuICBASW5wdXQoKVxuICBnZXQgc3RhcnQoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy5fc3RhcnQ7XG4gIH1cblxuICBzZXQgc3RhcnQobmV3U3RhcnQ6IG51bWJlcikge1xuICAgIHRoaXMuX3N0YXJ0ID0gbmV3U3RhcnQ7XG4gICAgdGhpcy5zZXR1cFBsYXllcldpdGhDdXJyZW50U2V0dGluZygpO1xuICB9XG5cbiAgQElucHV0KClcbiAgZ2V0IHdpZGdldFJlZmVycmVyKCk6IHN0cmluZyB8IHVuZGVmaW5lZCB7XG4gICAgcmV0dXJuIHRoaXMuX3dpZGdldFJlZmVycmVyO1xuICB9XG5cbiAgc2V0IHdpZGdldFJlZmVycmVyKG5ld1dpZGdldFJlZmVycmVyKSB7XG4gICAgdGhpcy5fd2lkZ2V0UmVmZXJyZXIgPSBuZXdXaWRnZXRSZWZlcnJlcjtcbiAgICB0aGlzLnNldHVwUGxheWVyV2l0aEN1cnJlbnRTZXR0aW5nKCk7XG4gIH1cblxuICBodG1sRWxlbWVudElkOiBzdHJpbmcgPSB0aGlzLmh0bWxJZFByZWZpeCArIHRoaXMuaWQ7XG4gIHByaXZhdGUgX3ByaXZhdGUgPSB0cnVlO1xuXG4gIEBJbnB1dCgpXG4gIGdldCBwcml2YXRlKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLl9wcml2YXRlO1xuICB9XG5cbiAgc2V0IHByaXZhdGUobmV3UHJpdmF0ZSkge1xuICAgIGlmICh0aGlzLl9wcml2YXRlICE9PSBuZXdQcml2YXRlKSB7XG4gICAgICB0aGlzLl9wcml2YXRlID0gbmV3UHJpdmF0ZTtcbiAgICAgIHRoaXMuc2V0dXBQbGF5ZXJXaXRoQ3VycmVudFNldHRpbmcoKTtcbiAgICB9XG4gIH1cblxuICBASW5wdXQoKVxuICBnZXQgaWQoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gdGhpcy5faWQudmFsdWU7XG4gIH1cblxuICBzZXQgaWQobmV3SWQpIHtcbiAgICBjb25zdCBwcmV2SWQgPSB0aGlzLl9pZC52YWx1ZTtcbiAgICBpZiAodGhpcy5wbGF5ZXJNYW5hZ2VyLmhhcyhwcmV2SWQpKSB7XG4gICAgICB0aGlzLnBsYXllck1hbmFnZXIuZGVsZXRlKHByZXZJZCk7XG4gICAgfVxuXG4gICAgdGhpcy5faWQubmV4dChuZXdJZCk7XG5cbiAgICBpZiAodGhpcy5wbGF5ZXIpIHtcbiAgICAgIHRoaXMuYWRkVG9QbGF5ZXJNYW5hZ2VyKHRoaXMucGxheWVyKTtcbiAgICB9XG5cbiAgICB0aGlzLmh0bWxFbGVtZW50SWQgPSB0aGlzLmh0bWxJZFByZWZpeCArIG5ld0lkO1xuICB9XG5cbiAgQElucHV0KClcbiAgZ2V0IGhlaWdodCgpOiBudW1iZXIge1xuICAgIHJldHVybiB0aGlzLl9oZWlnaHQ7XG4gIH1cblxuICBzZXQgaGVpZ2h0KG5ld0hlaWdodDogbnVtYmVyKSB7XG4gICAgdGhpcy5faGVpZ2h0ID0gbmV3SGVpZ2h0O1xuICAgIHRoaXMucGxheWVyPy5zZXRTaXplKHRoaXMud2lkdGgsIHRoaXMuaGVpZ2h0KTtcbiAgfVxuXG4gIEBJbnB1dCgpXG4gIGdldCB3aWR0aCgpOiBudW1iZXIge1xuICAgIHJldHVybiB0aGlzLl93aWR0aDtcbiAgfVxuXG4gIHNldCB3aWR0aChuZXdXaWR0aDogbnVtYmVyKSB7XG4gICAgdGhpcy5fd2lkdGggPSBuZXdXaWR0aDtcbiAgICB0aGlzLnBsYXllcj8uc2V0U2l6ZSh0aGlzLndpZHRoLCB0aGlzLmhlaWdodCk7XG4gIH1cblxuICBASW5wdXQoKVxuICBnZXQgdmlkZW9JZCgpOiBzdHJpbmcge1xuICAgIHJldHVybiB0aGlzLl92aWRlb0lkO1xuICB9XG5cbiAgc2V0IHZpZGVvSWQobmV3VmlkZW9JZDogc3RyaW5nKSB7XG4gICAgdGhpcy5fdmlkZW9JZCA9IG5ld1ZpZGVvSWQ7XG4gICAgdGhpcy5wbGF5ZXI/LmxvYWRWaWRlb0J5SWQodGhpcy52aWRlb0lkLCB0aGlzLnN0YXJ0KTtcbiAgfVxuXG4gIHByb3RlY3RlZCBnZXQgYXBpKCk6IFlvdVR1YmVJRnJhbWVBcGkgfCB1bmRlZmluZWQge1xuICAgIHJldHVybiB0aGlzLmlGcmFtZUFwaS5hcGk7XG4gIH1cblxuICBnZXQgcGxheWVyKCk6IFlvdVR1YmVQbGF5ZXIgfCB1bmRlZmluZWQge1xuICAgIHJldHVybiB0aGlzLl9wbGF5ZXIudmFsdWU7XG4gIH1cblxuICBwcm90ZWN0ZWQgc2V0IHBsYXllcihuZXdQbGF5ZXIpIHtcbiAgICB0aGlzLl9wbGF5ZXIubmV4dChuZXdQbGF5ZXIpO1xuICB9XG5cbiAgY29uc3RydWN0b3IoXG4gICAgcHJpdmF0ZSBwbGF5ZXJNYW5hZ2VyOiBZb3VUdWJlUGxheWVyTWFuYWdlclNlcnZpY2UsXG4gICAgcHJpdmF0ZSBpRnJhbWVBcGk6IFlvdVR1YmVJRnJhbWVBcGlTZXJ2aWNlXG4gICkge1xuICAgIHRoaXMuc3Vic2NyaXB0aW9ucy5wdXNoKFxuICAgICAgdGhpcy5pRnJhbWVBcGkuYXBpQ2hhbmdlLnN1YnNjcmliZSh7XG4gICAgICAgIGVycm9yOiAoZXJyKSA9PiB7XG4gICAgICAgICAgdGhyb3cgZXJyO1xuICAgICAgICB9LFxuICAgICAgfSlcbiAgICApO1xuICB9XG5cbiAgbmdPbkluaXQoKSB7XG4gICAgdGhpcy5zdWJzY3JpcHRpb25zLnB1c2goXG4gICAgICB0aGlzLl9wbGF5ZXIuc3Vic2NyaWJlKChuZXdQbGF5ZXIpID0+IHtcbiAgICAgICAgdGhpcy5wbGF5ZXJDaGFuZ2UuZW1pdChuZXdQbGF5ZXIpO1xuICAgICAgfSlcbiAgICApO1xuICAgIHRoaXMuc2V0dXBQbGF5ZXJXaXRoQ3VycmVudFNldHRpbmcoKTtcbiAgfVxuXG4gIG5nT25EZXN0cm95KCk6IHZvaWQge1xuICAgIHRoaXMuc3Vic2NyaXB0aW9ucy5mb3JFYWNoKCh4KSA9PiB4LnVuc3Vic2NyaWJlKCkpO1xuXG4gICAgdGhpcy5yZWFkeS5jb21wbGV0ZSgpO1xuICAgIHRoaXMuc3RhdGVDaGFuZ2UuY29tcGxldGUoKTtcbiAgICB0aGlzLmFwaUNoYW5nZS5jb21wbGV0ZSgpO1xuICAgIHRoaXMucGxheWJhY2tSYXRlQ2hhbmdlLmNvbXBsZXRlKCk7XG4gICAgdGhpcy5wbGF5YmFja1F1YWxpdHlDaGFuZ2UuY29tcGxldGUoKTtcbiAgICB0aGlzLnBsYXllckNoYW5nZS5jb21wbGV0ZSgpO1xuXG4gICAgdGhpcy5yZWFkeS5jb21wbGV0ZSgpO1xuICAgIHRoaXMuc3RhdGVDaGFuZ2UuY29tcGxldGUoKTtcbiAgICB0aGlzLmFwaUNoYW5nZS5jb21wbGV0ZSgpO1xuICAgIHRoaXMucGxheWJhY2tRdWFsaXR5Q2hhbmdlLmNvbXBsZXRlKCk7XG4gICAgdGhpcy5wbGF5YmFja1JhdGVDaGFuZ2UuY29tcGxldGUoKTtcbiAgICB0aGlzLmVycm9yT2NjdXJyZW5jZS5jb21wbGV0ZSgpO1xuXG4gICAgdGhpcy5fcGxheWVyLmNvbXBsZXRlKCk7XG4gIH1cblxuICBzZXR1cFBsYXllcldpdGhDdXJyZW50U2V0dGluZygpIHtcbiAgICB0aGlzLnNldHVwUGxheWVyV2l0aCh0aGlzLmh0bWxFbGVtZW50SWQsIHtcbiAgICAgIGhlaWdodDogdGhpcy5oZWlnaHQsXG4gICAgICB3aWR0aDogdGhpcy53aWR0aCxcbiAgICAgIHZpZGVvSWQ6IHRoaXMudmlkZW9JZCxcbiAgICAgIGhvc3Q6IHRoaXMucHJpdmF0ZSA/IHRoaXMucHJpdmF0ZUhvc3QgOiB0aGlzLm5vblByaXZhdGVIb3N0LFxuICAgICAgcGxheWVyVmFyczoge1xuICAgICAgICBhdXRvcGxheTogYm9vbGVhblRvTnVtZXJpY0Jvb2xlYW4odGhpcy5hdXRvcGxheSksXG4gICAgICAgIGNjX2xhbmdfcHJlZjogdGhpcy5jY0xhbmdQcmVmLFxuICAgICAgICBjY19sb2FkX3BvbGljeTogYm9vbGVhblRvTnVtZXJpY0Jvb2xlYW4odGhpcy5jY0xvYWRQb2xpY3kpLFxuICAgICAgICBjb2xvcjogdGhpcy5jb2xvcixcbiAgICAgICAgY29udHJvbHM6IGJvb2xlYW5Ub051bWVyaWNCb29sZWFuKHRoaXMuY29udHJvbHMpLFxuICAgICAgICBkaXNhYmxla2I6IGJvb2xlYW5Ub051bWVyaWNCb29sZWFuKHRoaXMuZGlzYWJsZWtiKSxcbiAgICAgICAgZW5hYmxlanNhcGk6IGJvb2xlYW5Ub051bWVyaWNCb29sZWFuKHRoaXMuZW5hYmxlanNhcGkpLFxuICAgICAgICBlbmQ6IHRoaXMuZW5kLFxuICAgICAgICBmczogYm9vbGVhblRvTnVtZXJpY0Jvb2xlYW4odGhpcy5mcyksXG4gICAgICAgIGhsOiB0aGlzLmhsLFxuICAgICAgICBpdl9sb2FkX3BvbGljeTogdGhpcy5pdkxvYWRQb2xpY3ksXG4gICAgICAgIGxpc3Q6IHRoaXMubGlzdCxcbiAgICAgICAgbGlzdFR5cGU6IHRoaXMubGlzdFR5cGUsXG4gICAgICAgIGxvb3A6IGJvb2xlYW5Ub051bWVyaWNCb29sZWFuKHRoaXMubG9vcCksXG4gICAgICAgIG1vZGVzdGJyYW5kaW5nOiBib29sZWFuVG9OdW1lcmljQm9vbGVhbih0aGlzLm1vZGVzdGJyYW5kaW5nKSxcbiAgICAgICAgb3JpZ2luOiB0aGlzLm9yaWdpbixcbiAgICAgICAgcGxheWxpc3Q6IHRoaXMucGxheWxpc3QsXG4gICAgICAgIHBsYXlzaW5saW5lOiBib29sZWFuVG9OdW1lcmljQm9vbGVhbih0aGlzLnBsYXlzaW5saW5lKSxcbiAgICAgICAgcmVsOiBib29sZWFuVG9OdW1lcmljQm9vbGVhbih0aGlzLnJlbCksXG4gICAgICAgIHN0YXJ0OiB0aGlzLnN0YXJ0LFxuICAgICAgICB3aWRnZXRfcmVmZXJyZXI6IHRoaXMud2lkZ2V0UmVmZXJyZXIsXG4gICAgICB9LFxuICAgIH0pO1xuICB9XG5cbiAgc2V0dXBQbGF5ZXJXaXRoKFxuICAgIGVsZW1lbnRJZDogc3RyaW5nLFxuICAgIGNvbmZpZzogT21pdDxZb3VUdWJlQ29uZmlnLCAnZXZlbnRzJz5cbiAgKTogdm9pZCB7XG4gICAgY29uc3Qgc3Vic2NyaXB0aW9uID0gdGhpcy5pRnJhbWVBcGkuYXBpQ2hhbmdlLnN1YnNjcmliZSgoYXBpKSA9PiB7XG4gICAgICBpZiAoIWFwaSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHBsYXllciA9IG5ldyBhcGkuUGxheWVyKGVsZW1lbnRJZCwge1xuICAgICAgICAuLi5jb25maWcsXG4gICAgICAgIGV2ZW50czoge1xuICAgICAgICAgIG9uUmVhZHk6ICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMucGxheWVyID0gcGxheWVyO1xuICAgICAgICAgICAgdGhpcy5hZGRUb1BsYXllck1hbmFnZXIocGxheWVyKTtcbiAgICAgICAgICAgIHRoaXMucmVhZHkuZW1pdCgpO1xuICAgICAgICAgICAgc3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7XG4gICAgICAgICAgfSxcbiAgICAgICAgICBvblN0YXRlQ2hhbmdlOiAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgIHRoaXMuc3RhdGVDaGFuZ2UuZW1pdChldmVudC5kYXRhKTtcbiAgICAgICAgICB9LFxuICAgICAgICAgIG9uQXBpQ2hhbmdlOiAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgIHRoaXMuYXBpQ2hhbmdlLmVtaXQoZXZlbnQpO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgb25FcnJvcjogKGV2ZW50KSA9PiB7XG4gICAgICAgICAgICB0aGlzLmVycm9yT2NjdXJyZW5jZS5lbWl0KGV2ZW50LmRhdGEpO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgb25QbGF5YmFja1F1YWxpdHlDaGFuZ2U6IChldmVudCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5wbGF5YmFja1F1YWxpdHlDaGFuZ2UuZW1pdChldmVudC5kYXRhKTtcbiAgICAgICAgICB9LFxuICAgICAgICAgIG9uUGxheWJhY2tSYXRlQ2hhbmdlOiAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgIHRoaXMucGxheWJhY2tSYXRlQ2hhbmdlLmVtaXQoZXZlbnQuZGF0YSk7XG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgcHJpdmF0ZSBhZGRUb1BsYXllck1hbmFnZXIobmV3UGxheWVyOiBZb3VUdWJlUGxheWVyKSB7XG4gICAgdGhpcy5wbGF5ZXJNYW5hZ2VyLmFkZCh0aGlzLmlkLCB7XG4gICAgICBwbGF5ZXI6IG5ld1BsYXllcixcbiAgICAgIHJlYWR5OiB0aGlzLnJlYWR5LmFzT2JzZXJ2YWJsZSgpLFxuICAgICAgc3RhdGVDaGFuZ2U6IHRoaXMuc3RhdGVDaGFuZ2UuYXNPYnNlcnZhYmxlKCksXG4gICAgICBhcGlDaGFuZ2U6IHRoaXMuYXBpQ2hhbmdlLmFzT2JzZXJ2YWJsZSgpLFxuICAgICAgcGxheWJhY2tRdWFsaXR5Q2hhbmdlOiB0aGlzLnBsYXliYWNrUXVhbGl0eUNoYW5nZS5hc09ic2VydmFibGUoKSxcbiAgICAgIHBsYXliYWNrUmF0ZUNoYW5nZTogdGhpcy5wbGF5YmFja1JhdGVDaGFuZ2UuYXNPYnNlcnZhYmxlKCksXG4gICAgICBlcnJvck9jY3VycmVuY2U6IHRoaXMuZXJyb3JPY2N1cnJlbmNlLmFzT2JzZXJ2YWJsZSgpLFxuICAgIH0pO1xuICB9XG59XG4iLCI8ZGl2IFtpZF09XCJodG1sRWxlbWVudElkXCI+PC9kaXY+XG4iXX0=